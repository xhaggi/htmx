!function(e,t){"function"==typeof define&&define.amd?define(["htmx.org"],t):"object"==typeof module&&module.exports?module.exports=t(require("htmx.org")):t(e.htmx)}("undefined"!=typeof self?self:this,(function(e){return function(){var t;function n(e){return new EventSource(e,{withCredentials:!0})}function r(e){return e.trim().split(/\s+/)}function s(n,u){if(null==n)return null;var c=t.getInternalData(n),l=t.getAttributeValue(n,"sse-connect");if(null==l){var f=function(e){var n=t.getAttributeValue(e,"hx-sse");if(n)for(var s=r(n),i=0;i<s.length;i++){var a=s[i].split(/:(.+)/);if("connect"===a[0])return a[1]}}(n);if(!f)return null;l=f}var v=e.createEventSource(l);c.sseEventSource=v,v.onerror=function(e){if(t.triggerErrorEvent(n,"htmx:sseError",{error:e,source:v}),!i(n)&&v.readyState===EventSource.CLOSED){u=u||0;var r=Math.random()*(2^u)*500;window.setTimeout((function(){s(n,Math.min(7,u+1))}),r)}},v.onopen=function(e){t.triggerEvent(n,"htmx::sseOpen",{source:v})},a(n,"sse-swap").forEach((function(e){var s=t.getAttributeValue(e,"sse-swap");if(s)var a=s.split(",");else a=function(e){var n=t.getAttributeValue(e,"hx-sse"),s=[];if(n)for(var i=r(n),a=0;a<i.length;a++){var o=i[a].split(/:(.+)/);"swap"===o[0]&&s.push(o[1])}return s}(e);for(var u=0;u<a.length;u++){var c=a[u].trim(),l=function(r){i(n)?v.removeEventListener(c,l):(o(e,r.data),t.triggerEvent(n,"htmx:sseMessage",r))};t.getInternalData(n).sseEventListener=l,v.addEventListener(c,l)}})),a(n,"hx-trigger").forEach((function(r){var s=t.getAttributeValue(r,"hx-trigger");if(null!=s&&"sse:"==s.slice(0,4)){var a=function(t){i(n)?v.removeEventListener(s,a):(e.trigger(r,s,t),e.trigger(r,"htmx:sseMessage",t))};t.getInternalData(n).sseEventListener=a,v.addEventListener(s.slice(4),a)}}))}function i(e){if(!t.bodyContains(e)){var n=t.getInternalData(e).sseEventSource;if(null!=n)return n.close(),!0}return!1}function a(e,n){var r=[];return(t.hasAttribute(e,n)||t.hasAttribute(e,"hx-sse"))&&r.push(e),e.querySelectorAll("["+n+"], [data-"+n+"], [hx-sse], [data-hx-sse]").forEach((function(e){r.push(e)})),r}function o(n,r){t.withExtensions(n,(function(e){r=e.transformResponse(r,null,n)}));var s=t.getSwapSpecification(n),i=t.getTarget(n),a=t.makeSettleInfo(n);t.selectAndSwap(s.swapStyle,i,n,r,a),a.elts.forEach((function(n){n.classList&&n.classList.add(e.config.settlingClass),t.triggerEvent(n,"htmx:beforeSettle")})),s.settleDelay>0?setTimeout(u(a),s.settleDelay):u(a)()}function u(n){return function(){n.tasks.forEach((function(e){e.call()})),n.elts.forEach((function(n){n.classList&&n.classList.remove(e.config.settlingClass),t.triggerEvent(n,"htmx:afterSettle")}))}}e.defineExtension("sse",{init:function(r){t=r,null==e.createEventSource&&(e.createEventSource=n)},onEvent:function(e,n){switch(e){case"htmx:beforeCleanupElement":var r=t.getInternalData(n.target);return void(r.sseEventSource&&r.sseEventSource.close());case"htmx:afterProcessNode":s(n.target)}}})}(),e}));